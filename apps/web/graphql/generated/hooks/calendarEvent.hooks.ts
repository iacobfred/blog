/* Do not edit this file. It was generated programmatically. */

import { MutationHookOptions } from "@apollo/client";
import {
  CREATE_CALENDAR_EVENT,
  UPDATE_CALENDAR_EVENT,
  updateCacheAfterCreatingCalendarEvent,
} from "@web/graphql/generated/mutations/calendarEvent.mutations";
import { CalendarEventFragment } from "@web/graphql/generated/fragments/calendarEvent.fragment";
import {
  CalendarEventCreationArgs,
  CalendarEventUpdateArgs,
} from "@web/graphql/generated/args/calendarEvent.args";
import { useHandleMutation } from "@web/utils/data/mutation";
import { Payload, ArrayAction } from "@web/utils/data/reduction";
import { useEffect, useReducer, Dispatch } from "react";
import {
  calendarEventReducer,
  calendarEventsReducer,
  CalendarEventData,
  initializeCalendarEventData,
} from "@web/graphql/generated/reducers/calendarEvent.reducer";
import { useUser } from "@web/components/contexts/UserContext";
import {
  calendarEventCreationInputSchema,
  calendarEventUpdateInputSchema,
} from "@web/graphql/generated/schemas/calendarEvent.schemas";
import { getOptimisticResponseForCalendarEventCreation } from "@web/graphql/generated/mutations/calendarEvent.mutations";

type CalendarEventCreationMutationHookOptions = MutationHookOptions<
  { createCalendarEvent: CalendarEventFragment },
  CalendarEventCreationArgs
>;

export const useCreateCalendarEvent = (options?: CalendarEventCreationMutationHookOptions) => {
  return useHandleMutation<
    { createCalendarEvent: CalendarEventFragment },
    CalendarEventCreationArgs
  >(
    CREATE_CALENDAR_EVENT,
    { ...updateCacheAfterCreatingCalendarEvent, ...(options ?? {}) },
    calendarEventCreationInputSchema,
    getOptimisticResponseForCalendarEventCreation
  );
};

type CalendarEventUpdateMutationHookOptions = MutationHookOptions<
  { updateCalendarEvent: CalendarEventFragment },
  CalendarEventUpdateArgs
>;

export const useUpdateCalendarEvent = (options?: CalendarEventUpdateMutationHookOptions) => {
  return useHandleMutation<{ updateCalendarEvent: CalendarEventFragment }, CalendarEventUpdateArgs>(
    UPDATE_CALENDAR_EVENT,
    options,
    calendarEventUpdateInputSchema
  );
};

export const useCalendarEventReducer = (
  data?: CalendarEventData
): [CalendarEventData, Dispatch<Payload<CalendarEventData>>] => {
  const { user } = useUser();
  const starterData = data ?? {};
  const initializedData = initializeCalendarEventData(starterData, user);
  const [calendarEventData, dispatchCalendarEventData] = useReducer(
    calendarEventReducer,
    initializedData,
    initializeCalendarEventData
  );
  useEffect(() => {
    if (user?.id && !calendarEventData?.userId) {
      dispatchCalendarEventData({
        field: "init",
        value: initializeCalendarEventData(calendarEventData, user),
      });
    }
  }, [user, calendarEventData]);
  return [calendarEventData, dispatchCalendarEventData];
};

export const useCalendarEventsReducer = (
  data: CalendarEventFragment[]
): [CalendarEventFragment[], Dispatch<ArrayAction<CalendarEventFragment>>] => {
  return useReducer(calendarEventsReducer, data);
};
