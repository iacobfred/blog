/* Do not edit this file. It was generated programmatically. */

import { gql, MutationHookOptions } from "@apollo/client";
import { ListItemCreationArgs } from "@web/generated/graphql/args/listItem.args";
import {
  listItemFragment,
  ListItemFragment,
} from "@web/generated/graphql/fragments/listItem.fragment";
import {
  ListItemCreationInput,
  ListItemUpdateInput,
} from "@web/generated/graphql/inputs/listItem.inputs";
import { ObjectID } from "bson";

export const CREATE_LIST_ITEM = gql`
  mutation CreateListItem($data: ListItemCreationInput!) {
    createListItem(data: $data) {
      ...ListItemFragment
    }
  }
  ${listItemFragment}
`;

export const getOptimisticResponseForListItemCreation = (
  data: ListItemCreationInput
): { createListItem: ListItemFragment } => {
  const now = new Date();
  return {
    createListItem: {
      __typename: "ListItem",
      id: new ObjectID().toHexString(),
      archivedAt: null,
      ...data,
      createdAt: now,
      updatedAt: now,
    },
  };
};

export const updateCacheAfterCreatingListItem: MutationHookOptions<
  { createListItem: ListItemFragment },
  ListItemCreationArgs
> = {
  update(cache, { data }) {
    const { createListItem } = data || {};
    if (createListItem) {
      const newListItemRef = cache.writeFragment({
        data: createListItem,
        fragment: gql`
          fragment NewListItem on ListItem {
            ...ListItemFragment
          }
          ${listItemFragment}
        `,
        fragmentName: "NewListItem",
      });
      cache.modify({
        id: `User:${createListItem.userId}`,
        fields: {
          listItems(existingListItemRefs = []) {
            return [...existingListItemRefs, newListItemRef];
          },
        },
      });
      cache.modify({
        fields: {
          listItems(existingListItems = []) {
            return [...existingListItems, newListItemRef];
          },
        },
      });
    }
  },
};

export const UPDATE_LIST_ITEM = gql`
  mutation UpdateListItem($where: ListItemWhereUniqueInput!, $data: ListItemUpdateInput!) {
    updateListItem(where: $where, data: $data) {
      ...ListItemFragment
    }
  }
  ${listItemFragment}
`;

export const getOptimisticResponseForListItemUpdate = (
  fragment: ListItemFragment,
  data: ListItemUpdateInput
) => {
  const now = new Date();
  return {
    updateListItem: {
      __typename: "ListItem",
      ...fragment,
      ...data,
      updatedAt: now,
    },
  };
};

export const UPSERT_LIST_ITEM = gql`
  mutation UpdateListItem($where: ListItemWhereUniqueInput!, $data: ListItemCreationInput!) {
    upsertListItem(where: $where, data: $data) {
      ...ListItemFragment
    }
  }
  ${listItemFragment}
`;

export const UPDATE_LIST_ITEMS = gql`
  mutation UpdateListItems($where: ListItemWhereInput!, $data: ListItemUpdateInput!) {
    updateListItems(where: $where, data: $data) {
      ...ListItemFragment
    }
  }
  ${listItemFragment}
`;

export const UPDATE_LIST_ITEMS_DISTINCTLY = gql`
  mutation UpdateListItemsDistinctly($data: [ListItemUpdateInput!]!) {
    updateListItemsDistinctly(data: $data) {
      ...ListItemFragment
    }
  }
  ${listItemFragment}
`;
