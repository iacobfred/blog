/* Do not edit this file. It was generated programmatically. */

import { AccountCreationArgs, AccountUpdateArgs } from "@/generated/args/account.args";
import { AccountFragment } from "@/generated/fragments/account.fragment";
import {
  CREATE_ACCOUNT,
  updateCacheAfterCreatingAccount,
  UPDATE_ACCOUNT,
} from "@/generated/mutations/account.mutations";
import {
  AccountData,
  accountDataReducer,
  initializeAccountData,
} from "@/generated/reducers/account.reducer";
import { Payload, useHandleMutation } from "@/utils/data";
import { MutationHookOptions } from "@apollo/client";
import { Dispatch, useEffect, useReducer } from "react";
// import { useUser } from "@/components/contexts/UserContext";

type AccountCreationMutationHookOptions = MutationHookOptions<
  { createAccount: AccountFragment },
  AccountCreationArgs
>;

export const useCreateAccount = (options?: AccountCreationMutationHookOptions) => {
  return useHandleMutation<{ createAccount: AccountFragment }, AccountCreationArgs>(
    CREATE_ACCOUNT,
    {
      ...updateCacheAfterCreatingAccount,
      ...(options ?? {}),
    }
  );
};

type AccountUpdateMutationHookOptions = MutationHookOptions<
  { updateAccount: AccountFragment },
  AccountUpdateArgs
>;

export const useUpdateAccount = (options?: AccountUpdateMutationHookOptions) => {
  return useHandleMutation<{ updateAccount: AccountFragment }, AccountUpdateArgs>(
    UPDATE_ACCOUNT,
    options
  );
};

export const useAccountDataReducer = (
  data: AccountData
): [AccountData, Dispatch<Payload<AccountData>>] => {
  const initialData = initializeAccountData(data);
  const [accountData, dispatchAccountData] = useReducer(
    accountDataReducer,
    initialData,
    initializeAccountData
  );
  useEffect(() => {
    if (data.userId && !accountData?.userId) {
      console.log("Dispatching account data!");
      dispatchAccountData({ field: "init", value: data });
    }
  }, [data, accountData]);
  return [accountData, dispatchAccountData];
};
